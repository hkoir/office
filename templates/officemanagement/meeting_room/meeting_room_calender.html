{% extends 'base.html' %}
{% load custom_filters %}
{% block content %}

<script src='https://cdn.jsdelivr.net/npm/@fullcalendar/core@6.1.15/index.global.min.js'></script>
<script src='https://cdn.jsdelivr.net/npm/@fullcalendar/daygrid@6.1.15/index.global.min.js'></script>



<style>
    /* Allow event text to wrap */
    .fc-event-title {
        white-space: normal !important;
        overflow: hidden;
        text-overflow: ellipsis;
        display: block;
        word-wrap: break-word;
    }

    /* Increase row height for better readability */
    .fc-daygrid-event {
        white-space: normal !important;
        height: auto !important;
        line-height: 1.2 !important;
        padding: 2px !important;
    }

    /* Optional: Increase space for events */
    .fc-daygrid-day {
        min-height: 80px; /* Adjust this if needed */
    }
</style>



<div class="card shadow-sm my-5">
  <div class="card-header bg-primary text-white text-center">
    <h5 class="mb-0">Office Management Actions</h5>
  </div>
  <div class="card-body text-center d-flex flex-wrap justify-content-center gap-2">


    <a href="{% url 'officemanagement:office_expense_advance' %}" 
       class="btn btn-info btn-sm">
       <i class="fas fa-money-bill-wave"></i> Expense / Advance
    </a>

    <a href="{% url 'officemanagement:office_meeting_room_booking' %}" 
       class="btn btn-warning btn-sm text-white">
       <i class="fas fa-handshake"></i> Meeting Room Booking
    </a>

    <a href="{% url 'officemanagement:office_visitor_management' %}" 
       class="btn btn-secondary btn-sm">
       <i class="fas fa-user-friends"></i> Visitor Management
    </a>

    <a href="{% url 'officemanagement:office_documentations' %}" 
       class="btn btn-dark btn-sm">
       <i class="fas fa-file-alt"></i> Documentations
    </a>

       <a href="{% url 'officemanagement:office_supplies_stationary' %}" 
       class="btn btn-dark btn-sm">
       <i class="fas fa-file-alt"></i> Office Supplies & Stationary
    </a>

    <a href="{% url 'officemanagement:office_it_support_ticket' %}" 
       class="btn btn-dark btn-sm">
       <i class="fas fa-file-alt"></i> IT support
    </a>

    <a href="{% url 'officemanagement:inventory_report' %}" 
       class="btn btn-dark btn-sm">
       <i class="fas fa-file-alt"></i> Inventory Report
    </a>

    <a href="{% url 'officemanagement:visitor_reports' %}" 
       class="btn btn-dark btn-sm">
       <i class="fas fa-file-alt"></i> Visitor Report
    </a>

    <a href="{% url 'officemanagement:meeting_room_report' %}" 
       class="btn btn-dark btn-sm">
       <i class="fas fa-file-alt"></i> Meeting room report
    </a>

    <a href="{% url 'officemanagement:advance_reconcilation_report' %}" 
       class="btn btn-dark btn-sm">
       <i class="fas fa-file-alt"></i> Advance reconcilation report
    </a>
    <a href="{% url 'officemanagement:top_expense_categories' %}" 
       class="btn btn-dark btn-sm">
       <i class="fas fa-file-alt"></i> top expense categories
    </a>

  </div>
</div>
<h2>Meeting Room: {{ room.name }}</h2>



<h4 class="mb-5"><a href="{% url 'officemanagement:book_meeting_room' room.id %}">Book this Room</a></h4>


<div id="calendar"></div>

<script id="bookings-data" type="application/json">
    {{ bookings_json|safe }}
</script>



<script>
  document.addEventListener("DOMContentLoaded", function () {
    var calendarEl = document.getElementById("calendar");
    var eventData = JSON.parse(document.getElementById("bookings-data").textContent);

    var calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: "dayGridMonth", 
        headerToolbar: {
            left: "prev,next today",
            center: "title",
            right: "dayGridMonth,timeGridWeek,timeGridDay", 
        },
        events: eventData,
        eventColor: "#007bff",
        eventTextColor: "#fff",
        dayMaxEventRows: true, 
        navLinks: true, 
 
        dateClick: function (info) {
            calendar.changeView("timeGridDay", info.dateStr); 
        },

        slotDuration: "00:30:00", 
        slotLabelInterval: "01:00", 
        slotMinTime: "00:00:00", 
        slotMaxTime: "24:00:00", 
        allDaySlot: false, 
        expandRows: true, 
        height: "auto", 


        // Render event with clickable link and formatted time
        eventContent: function (arg) {
            let eventTime = arg.event.start.toLocaleTimeString([], {
                hour: "2-digit",
                minute: "2-digit",
                hour12: true,
            }) + " - " +
            arg.event.end.toLocaleTimeString([], {
                hour: "2-digit",
                minute: "2-digit",
                hour12: true,
            });
        // let eventStatus = arg.event.extendedProps.status || "No Status"; 

            return {
                html: `<div style="white-space: normal;">
                            <strong>${eventTime}</strong><br>
                            <a href="${arg.event.url}" style="color:blue; text-decoration:underline;">${arg.event.title}</a>
                              
                       </div>`,
            };
        },
    });

    calendar.render();

    // Optional: Add a "Back to Month View" button
    document.getElementById("back-to-month").addEventListener("click", function () {
        calendar.changeView("dayGridMonth");
    });
});

</script>







{% endblock %}





